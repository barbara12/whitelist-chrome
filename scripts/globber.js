(function(){var Globber,StringBuffer,root;root=typeof exports!=="undefined"&&exports!==null?exports:this;Globber=function(){Globber.prototype.__isGlobMetaCharacter=function(ch){return"*?[]".indexOf(ch)>=0};Globber.prototype.__isRegExpMetaCharacter=function(ch){return"'*?+[]()|^$.{}/\\".indexOf(ch)>=0};function Globber(pattern,options){var buffer,caseInsensitive,ch,inCharSet,questionCanMatchZero,starCannotMatchZero,_i,_ref;if(!(options!=null)){options=Globber.DEFAULT_MASK}caseInsensitive=(options&Globber.CASE_INSENSITIVE_MASK)!==0;starCannotMatchZero=(options&Globber.STAR_CANNOT_MATCH_ZERO_MASK)!==0;questionCanMatchZero=(options&Globber.QUESTION_CAN_MATCH_ZERO_MASK)!==0;buffer=new StringBuffer;inCharSet=false;for(ch=_i=0,_ref=pattern.length;0<=_ref?_i<_ref:_i>_ref;ch=0<=_ref?++_i:--_i){switch(pattern[ch]){case"*":if(inCharSet){buffer.append("*")}else{buffer.append(starCannotMatchZero?".+":".*")}break;case"?":if(inCharSet){buffer.append("?")}else{buffer.append(questionCanMatchZero?".?":".")}break;case"[":inCharSet=true;buffer.append(pattern[ch]);if(ch+1<pattern.length){switch(pattern[ch+1]){case"!":case"^":buffer.append("^");ch++;break;case"]":buffer.append("]");ch++}}break;case"]":inCharSet=false;buffer.append(pattern[ch]);break;case"\\":buffer.append("\\");if(ch===pattern.length-1){buffer.append("\\")}else if(this.__isGlobMetaCharacter(pattern[ch+1])){buffer.append(pattern[++ch])}else{buffer.append("\\")}break;default:if(!inCharSet&&this.__isRegExpMetaCharacter(pattern[ch])){buffer.append("\\")}buffer.append(pattern[ch])}}this.regexp=buffer.toString();if(pattern.match(/^[^.*]+\.[^.]+$/)){this.regexp="(.+\\.)?"+this.regexp}this.regexp="^"+this.regexp+"$";this.mods="";if(caseInsensitive){this.mods+=Globber.CASE_INSENSITIVE_MOD}}Globber.prototype.compile=function(){return new RegExp(this.regexp,this.mods)};Globber.prototype.toString=function(){return"/"+this.regexp+"/"+this.mods};return Globber}();Globber.CASE_INSENSITIVE_MASK=1;Globber.STAR_CANNOT_MATCH_ZERO_MASK=2;Globber.QUESTION_CAN_MATCH_ZERO_MASK=3;Globber.DEFAULT_MASK=Globber.CASE_INSENSITIVE_MASK;Globber.CASE_INSENSITIVE_MOD="i";StringBuffer=function(){function StringBuffer(){this.buffer=[]}StringBuffer.prototype.append=function(string){this.buffer.push(string);return this.buffer};StringBuffer.prototype.toString=function(){return this.buffer.join("")};return StringBuffer}();root.Globber=Globber}).call(this);